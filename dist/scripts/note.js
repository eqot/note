(function(){"use strict";var a;a=function(){function a(a){this.note=a,this.dom=this.note.getDom(),this.listeners=[]}return a.prototype.SCALE=64,a.prototype.state=null,a.prototype.note=null,a.prototype.dom=null,a.prototype.listeners=null,a.prototype.activate=function(){var a,b,c,d,e,f;return this.addListener(this.dom,"mousedown",null!=(a=this.onDown)?a.bind(this):void 0),this.addListener(this.dom,"mousemove",null!=(b=this.onMove)?b.bind(this):void 0),this.addListener(this.dom,"mouseup",null!=(c=this.onUp)?c.bind(this):void 0),this.addListener(this.dom,"touchstart",null!=(d=this.onDown)?d.bind(this):void 0),this.addListener(this.dom,"touchmove",null!=(e=this.onMove)?e.bind(this):void 0),this.addListener(this.dom,"touchend",null!=(f=this.onUp)?f.bind(this):void 0)},a.prototype.deactivate=function(){return this.removeAllListeners()},a.prototype.addListener=function(a,b,c){return a.addEventListener(b,c,!0),this.listeners.push([a,b,c])},a.prototype.removeAllListeners=function(){var a,b,c,d,e,f,g,h;for(f=this.listeners,h=[],d=0,e=f.length;e>d;d++)g=f[d],c=g[0],a=g[1],b=g[2],h.push(c.removeEventListener(a,b,!0));return h},a.prototype.getPoint=function(a){return null!=a.touches?[a.touches[0].clientX,a.touches[0].clientY]:[a.x,a.y]},a.prototype.onNativeDown=function(a,b){return"function"==typeof this.onDown?this.onDown({x:a/this.SCALE,y:b/this.SCALE}):void 0},a.prototype.onNativeMove=function(a,b){return"function"==typeof this.onMove?this.onMove({x:a/this.SCALE,y:b/this.SCALE}):void 0},a.prototype.onNativeUp=function(){return"function"==typeof this.onUp?this.onUp():void 0},a}(),window.HandlerBase=a}).call(this),function(){"use strict";var a,b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};a=function(a){function b(a){b.__super__.constructor.call(this,a),this.focus=new Focus,this.focusedElements=[],this.state=this.State.RELEASE}return c(b,a),b.prototype.State={RELEASE:0,PRESS:1},b.prototype.focus=null,b.prototype.focusedElements=null,b.prototype.focusPosition=null,b.prototype.deactivate=function(){return b.__super__.deactivate.call(this),this.removeFocusAll()},b.prototype.onDown=function(a){var b,c,d,e;return"function"==typeof a.preventDefault&&a.preventDefault(),this.removeFocusAll(),e=this.getPoint(a),c=e[0],d=e[1],this.focusPosition=[c,d],b=this.note.pick(c,d),"canvas"!==b.node.id&&this.setFocus(b),this.focus.setVisibility(!0),this.state=this.State.PRESS},b.prototype.onMove=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;return"function"==typeof a.preventDefault&&a.preventDefault(),this.state===this.State.PRESS?(j=this.focusPosition,e=j[0],h=j[1],k=this.getPoint(a),f=k[0],i=k[1],l=f>e?[e,f-e]:[f,e-f],d=l[0],c=l[1],m=i>h?[h,i-h]:[i,h-i],g=m[0],b=m[1],this.focus.setPosition(d,g),this.focus.setSize(c,b)):void 0},b.prototype.onUp=function(a){var b,c,d,e,f,g;if("function"==typeof a.preventDefault&&a.preventDefault(),this.state=this.State.RELEASE,c=this.focus.getBBox(),null!=c){for(d=[],g=this.note.getAllElements(),e=0,f=g.length;f>e;e++)b=g[e],Snap.path.isBBoxIntersect(c,b.getBBox())&&d.push(b);return console.log(d)}},b.prototype.setFocus=function(a){return this.focus.set(a),this.focusedElements.push(a),this.focus.setVisibility(!0),a.drag(),a.drag(this.moveFocus.bind(this),this.moveFocusStart.bind(this),this.moveFocusEnd.bind(this))},b.prototype.moveFocusStart=function(){return this.focusPosition=this.focus.getPosition()},b.prototype.moveFocus=function(a,b){var c,d,e;return e=this.focusPosition,c=e[0],d=e[1],this.focus.setPosition(c+a,d+b)},b.prototype.moveFocusEnd=function(){return this.focusPosition=null},b.prototype.removeFocusAll=function(){var a,b,c,d;for(d=this.focusedElements,b=0,c=d.length;c>b;b++)a=d[b],a.undrag();return this.focusedElements=[],this.focus.setVisibility(!1)},b}(HandlerBase),window.Pick=a}.call(this),function(){"use strict";var a,b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};a=function(a){function b(a){b.__super__.constructor.call(this,a),this.state=this.State.RELEASE}return c(b,a),b.prototype.State={RELEASE:0,PRESS:1},b.prototype.pathNode=null,b.prototype.prevX=null,b.prototype.prevY=null,b.prototype.onDown=function(a){var b,c;return"function"==typeof a.preventDefault&&a.preventDefault(),c=this.getPoint(a),this.prevX=c[0],this.prevY=c[1],b=this.note.drawPath("M"+this.prevX+","+this.prevY),this.pathNode=b.node,this.state=this.State.PRESS},b.prototype.onMove=function(a){var b,c,d;return"function"==typeof a.preventDefault&&a.preventDefault(),this.state===this.State.PRESS?(d=this.getPoint(a),b=d[0],c=d[1],this.pathNode.pathSegList.appendItem(this.pathNode.createSVGPathSegCurvetoQuadraticAbs((b+this.prevX)/2,(c+this.prevY)/2,this.prevX,this.prevY)),this.prevX=b,this.prevY=c):void 0},b.prototype.onUp=function(){return this.state=this.State.RELEASE},b}(HandlerBase),window.Freehand=a}.call(this),function(){"use strict";var a,b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};a=function(a){function b(a){b.__super__.constructor.call(this,a),this.state=this.State.RELEASE}return c(b,a),b.prototype.State={RELEASE:0,PRESS:1},b.prototype.startX=null,b.prototype.startY=null,b.prototype.rectangle=null,b.prototype.onDown=function(a){var b;return"function"==typeof a.preventDefault&&a.preventDefault(),b=this.getPoint(a),this.startX=b[0],this.startY=b[1],this.state=this.State.PRESS},b.prototype.onMove=function(a){var b,c,d,e;return"function"==typeof a.preventDefault&&a.preventDefault(),null!=(d=this.rectangle)&&d.remove(),this.state===this.State.PRESS?(e=this.getPoint(a),b=e[0],c=e[1],this.rectangle=this.note.drawRectangle(this.startX,this.startY,b,c)):void 0},b.prototype.onUp=function(a){return"function"==typeof a.preventDefault&&a.preventDefault(),this.rectangle=null,this.startX=this.startY=null,this.state=this.State.RELEASE},b}(HandlerBase),window.Rectangle=a}.call(this),function(){"use strict";var a;a=function(){function a(a){var b,c,d,e;for(this.note=a,this.dom=this.note.getDom(),e=document.querySelectorAll("#penwidth li"),c=0,d=e.length;d>c;c++)b=e[c],b.addEventListener("click",this.onClick.bind(this));this.element=document.querySelector("#penwidthvalue")}return a.prototype.note=null,a.prototype.dom=null,a.prototype.element=null,a.prototype.onClick=function(a){var b;return b=a.target.id,this.note.setStrokeWidth(b),this.element.innerHTML=b},a}(),window.PenWidth=a}.call(this),function(){"use strict";var a;a=function(){function a(a){this.s=Snap(a),this.layer=this.getNewLayer()}return a.prototype.s=null,a.prototype.layer=null,a.prototype.strokeColor="#000000",a.prototype.strokeWidth=2,a.prototype.fillColor="#ffffff",a.prototype.group=null,a.prototype.getDom=function(){return this.s.node},a.prototype.getNewLayer=function(){return this.s.g()},a.prototype.setStrokeWidth=function(a){return this.strokeWidth=a},a.prototype.drawLine=function(a,b,c,d){var e;return e=this.s.line(a,b,c,d),e.attr({stroke:this.strokeColor,strokeWidth:this.strokeWidth})},a.prototype.drawPolyline=function(a){var b;return b=this.s.polyline(a),b.attr({stroke:this.strokeColor,strokeWidth:this.strokeWidth,strokeLinecap:"round",strokeLinejoin:"round",fill:"none"}),this.layer.append(b)},a.prototype.drawPath=function(a){return a=this.s.path(a),a.attr({stroke:this.strokeColor,strokeWidth:this.strokeWidth,strokeLinecap:"round",strokeLinejoin:"round",fill:"none"}),this.layer.append(a),a},a.prototype.drawRectangle=function(a,b,c,d){var e,f,g,h,i,j,k;return j=c>a?[a,c-a]:[c,a-c],h=j[0],g=j[1],k=d>b?[b,d-b]:[d,b-d],i=k[0],e=k[1],f=this.s.rect(h,i,g,e),f.attr({stroke:this.strokeColor,strokeWidth:this.strokeWidth,fill:this.fillColor}),this.layer.append(f),f},a.prototype.pick=function(a,b){return Snap.getElementByPoint(a,b)},a.prototype.getAllElements=function(){return this.layer.node.children},a}(),window.Note=a}.call(this),function(){"use strict";var a;a=function(){function a(){this.element=document.querySelector("#focus"),this.setVisibility(!1)}return a.prototype.element=null,a.prototype.position=null,a.prototype.size=null,a.prototype.set=function(a){var b,c,d,e,f;return f=a.getBBox(),d=f.x,e=f.y,c=f.w,b=f.h,this.setPosition(d,e),this.setSize(c,b)},a.prototype.setPosition=function(a,b){return this.element.style.left=a+"px",this.element.style.top=b+"px",this.position=[a,b]},a.prototype.getPosition=function(){return this.position},a.prototype.setSize=function(a,b){return this.element.style.width=a+"px",this.element.style.height=b+"px",this.size=[a,b]},a.prototype.getBBox=function(){return null==this.position?null:{x:this.position[0],y:this.position[1],x2:this.position[0]+this.size[0],y2:this.position[1]+this.size[1]}},a.prototype.setVisibility=function(a){return a?this.element.classList.remove("hide"):this.element.classList.add("hide")},a}(),window.Focus=a}.call(this);